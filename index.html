<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <title>Nikhil filmy | AI Movie Discovery</title>
    <link rel="icon"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cdefs%3E%3ClinearGradient id='grad1' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300c6ff;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%230072ff;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath fill='url(%23grad1)' d='M448 32H64c-17.67 0-32 14.33-32 32v384c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM96 136c-13.25 0-24-10.75-24-24s10.75-24 24-24 24 10.75 24 24-10.75 24-24 24zm0 160c-13.25 0-24-10.75-24-24s10.75-24 24-24 24 10.75 24 24-10.75 24-24 24zm0 160c-13.25 0-24-10.75-24-24s10.75-24 24-24 24 10.75 24 24-10.75 24-24 24zM416 136c-13.25 0-24-10.75-24-24s10.75-24 24-24 24 10.75 24 24-10.75 24-24 24zm0 160c-13.25 0-24-10.75-24-24s10.75-24 24-24 24 10.75 24 24-10.75 24-24 24zm0 160c-13.25 0-24-10.75-24-24s10.75-24 24-24 24 10.75 24 24-10.75 24-24 24z'/%3E%3C/svg%3E"
        type="image/svg+xml">

    <style>
        html {
            scroll-behavior: smooth;
        }

        :root {
            --bg-dark: #0b0c10;
            --bg-card: #15161c;
            --brand-primary: #00c6ff;
            --brand-secondary: #0072ff;
            --brand-gradient: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
            --text-main: #ffffff;
            --text-muted: #94a3b8;
            --glass-bg: rgba(21, 22, 28, 0.85);
            --border-color: #2d3748;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Outfit', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--brand-primary);
        }


        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        main {
            flex: 1;
            width: 100%;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 5px;
            background: -webkit-linear-gradient(#00c6ff, #0072ff);
            width: 0;
            z-index: 9999;
            transition: width 0.2s ease-out;
        }

        header {
            text-align: center;
            padding: 3rem 1rem 1rem 1rem;
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 800;
            letter-spacing: -2px;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        h4 {
            font-size: 1.2rem;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            color: var(--brand-primary);
            text-transform: uppercase;
            opacity: 0.9;
        }

        p.subtitle {
            color: var(--text-muted);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .search-wrapper {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            gap: 15px;
            position: sticky;
            top: 5px;
            z-index: 100;
            -webkit-backdrop-filter: blur(16px);
            padding: 12px 20px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);

            background: rgb(21 22 28 / 81%);
            backdrop-filter: blur(4px);
        }

        .search-container {
            position: relative;
            flex: 2;
            display: flex;
            align-items: center;
        }

        #userPrompt {
            width: 100%;
            background: transparent;
            border: none;
            color: #fff;
            padding: 14px 15px;
            padding-right: 90px;
            font-size: 1.1rem;
            outline: none;
            resize: none;
            font-family: 'Outfit', sans-serif;
            line-height: 1.5;
            height: 55px;
            min-height: 55px;
            max-height: 120px;
            transition: height 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            overflow-y: hidden;
        }

        #userPrompt:focus {
            overflow-y: auto;
        }

        #userPrompt::placeholder {
            color: #555;
        }

        .search-wrapper:focus {
            border-color: #0072ff;
            border: 2px solid #0072ff;
            box-shadow: none;
        }

        button#btnGo {
            position: absolute;
            right: 0;
            bottom: 0;
            top: 0;
            margin: auto;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--brand-gradient);
            color: #fff;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(0, 198, 255, 0.3);
        }

        button#btnGo:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(0, 198, 255, 0.6);
        }

        button#btnGo:disabled {
            filter: grayscale(100%);
            cursor: not-allowed;
        }

        #btnClear {
            position: absolute;
            right: 55px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            color: #aaa;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #btnClear:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }


        .controls {
            display: none;
            justify-content: flex-end;
            align-items: center;
            gap: 10px;
            min-width: 220px;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            padding-left: 20px;
        }

        .custom-select {
            position: relative;
            width: 100%;
            cursor: pointer;
            font-size: 0.9rem;
            user-select: none;
        }

        .select-trigger {
            color: var(--text-muted);
            padding: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: color 0.3s;
        }

        .select-trigger:hover {
            color: #fff;
        }

        .select-options {
            position: absolute;
            top: 140%;
            right: 0;
            width: 240px;
            background: rgb(13 15 23 / 91%);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
            z-index: 200;
            backdrop-filter: blur(8px);
        }

        .select-options.open {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
            margin-top: 10px;
        }

        .option {
            padding: 12px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #ccc;
        }

        .option:last-child {
            border-bottom: none;
        }

        .option:hover {
            background: rgba(0, 198, 255, 0.1);
            color: var(--brand-primary);
        }

        .option i {
            width: 20px;
            text-align: center;
            color: var(--brand-primary);
        }

        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1.5rem;
            width: 100%;
            max-width: 1200px;
            padding: 3rem 2rem;
            animation: fadeIn 0.8s ease-out;
        }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            height: 320px;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid transparent;
            will-change: transform;
            opacity: 0;
            animation: fadeInUp 0.6s ease forwards;
        }

        .floating-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--brand-gradient);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(0, 114, 255, 0.4);
            z-index: 99;
            color: #fff;
            font-size: 1.2rem;
            text-decoration: none;
            transition: transform 0.3s;
            opacity: 0;
            pointer-events: none;
        }

        .floating-button.visible {
            opacity: 1;
            pointer-events: all;
        }

        .floating-button:hover {
            transform: translateY(-5px);
        }


        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 114, 255, 0.15);
            border-color: var(--brand-secondary);
        }

        .poster {
            height: 75%;
            background-color: #222;
            background-size: cover;
            background-position: center;
            width: 100%;
        }

        .info {
            padding: 1rem;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .title {
            font-weight: 700;
            font-size: 1rem;
            line-height: 1.3;
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .rating {
            color: #f3bd00f0;
            font-weight: 600;
        }

        .rating i {
            color: #f3bd00f0;
            margin-right: 4px;
        }

        #status {
            margin-top: 2rem;
            font-family: monospace;
            color: var(--text-muted);
            height: 20px;
        }

        footer a {
            font-size: 0.8rem;
            color: #ddd !important;
            text-decoration-line: none;
        }

        footer a:hover {
            color: #0072ff !important;
        }

        footer {
            text-align: center;
            padding: 20px;
            width: 100%;
            border-top: 1px solid #333;
            background: #0f1014;
            font-size: 0.9rem;
            color: #666;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }


        @media (max-width: 768px) {

            header {
                padding: 2rem 1rem 1rem 1rem;
            }

            h1 {
                font-size: 2.2rem;
            }

            h4 {
                font-size: 1rem;
                margin-bottom: 0.5rem;
            }

            p.subtitle {
                margin-bottom: 1rem;
                font-size: 0.8rem;
            }

            .search-wrapper {
                width: 92%;
                top: 10px;
                padding: 10px 15px;
                gap: 0;
            }

            .controls {
                display: none;
                border-left: none;
                padding-left: 10px;
                min-width: auto;
            }

            .controls>span {
                display: none;
            }

            .select-trigger {
                padding: 12px;
                justify-content: center;
            }

            #selectedText {
                display: none;
            }

            .select-trigger i {
                font-size: 1.2rem;
                color: var(--text-muted);
            }

            .select-options {
                width: 200px;
                right: -10px;
            }

            .movie-grid {
                padding: 1rem;
                gap: 1rem;
                grid-template-columns: repeat(2, 1fr);
            }

            .card {
                height: 260px;
            }

            #userPrompt {
                padding-right: 70px !important;
                font-size: 0.95rem;
                padding: 0px 5px;
            }

            button#btnGo {
                width: 35px;
                height: 35px;
            }

            #btnClear {
                right: 43px;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="progress-bar"></div>
        <h1>
            <i class="fa-solid fa-film"
                style="background: -webkit-linear-gradient(#00c6ff, #0072ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i>
            Nikhil Filmy
        </h1>
        <h4>AI Powered Movie Recommendations</h4>
        <p class="subtitle">Describe a vibe, plot, or feeling. AI does the rest.</p>
    </header>

    <div class="search-wrapper">
        <div class="search-container">

            <textarea id="userPrompt" rows="1" placeholder="e.g., 'Mind-bending sci-fi movies that are scary'"
                oninput="handleInput(this)" onfocus="handleInput(this)" onblur="shrinkInput(this)"></textarea>

            <button id="btnClear" onclick="clearSearch()" style="display: none;">
                <i class="fa-solid fa-xmark"></i>
            </button>

            <button id="btnGo" onclick="runLumina()">
                <i class="fa-solid fa-magnifying-glass"></i>
            </button>
        </div>

        <div class="controls" id="sortControls">
            <span style="color:#666; font-size:0.9rem; font-weight: 600;">Sort By:</span>
            <div class="custom-select" id="customSelect">
                <div class="select-trigger" onclick="toggleDropdown()">
                    <span id="selectedText">âœ¨ Relevance</span>
                    <i class="fa-solid fa-chevron-down" style="font-size: 0.8rem;"></i>
                </div>
                <div class="select-options">
                    <div class="option" onclick="selectOption('default', 'âœ¨ Relevance')"><i
                            class="fa-solid fa-wand-magic-sparkles"></i> Relevance</div>
                    <div class="option" onclick="selectOption('rating_high', 'â­ Rating: High to Low')"><i
                            class="fa-solid fa-arrow-up-9-1"></i> Rating: High to Low</div>
                    <div class="option" onclick="selectOption('rating_low', 'â­ Rating: Low to High')"><i
                            class="fa-solid fa-arrow-down-1-9"></i> Rating: Low to High</div>
                    <div class="option" onclick="selectOption('newest', 'ðŸ“… Release: Latest First')"><i
                            class="fa-regular fa-calendar-plus"></i> Release: Latest First</div>
                    <div class="option" onclick="selectOption('oldest', 'ðŸ“… Release: Oldest First')"><i
                            class="fa-regular fa-calendar-minus"></i> Release: Oldest First</div>
                </div>
            </div>
        </div>
    </div>

    <div id="status"></div>

    <main id="movieGrid" class="movie-grid"></main>

    <a href="#" class="floating-button" id="scrollTopBtn" title="Top" onclick="scrollToHome()">
        <i class="fa-solid fa-up-long"></i>
    </a>

    <footer>
        &copy; 2025 Developed by <a target="_blank" href="https://www.linkedin.com/in/sai-nikhil-898060175/"
            title="Connect with Me" style="font-weight: bold; color: #fff;">Sai Nikhil</a>
    </footer>

    <script>
        // API CONFIGURATION
        const MODEL_NAME = "gemini-2.5-flash-lite";
        const geminiKey = "AIzaSyA9YBLDtRCt7-OdX8ylLdkKgfoPz9eHBU0";
        const tmdbKey = "b6ed0366df58af3c63fae705358f25c9";
        const statusDiv = document.getElementById('status');

        let fetchedMovies = [];
        let currentSort = 'default';
        let abortController = null;

        function toggleDropdown() {
            document.querySelector('.select-options').classList.toggle('open');
        }

        function selectOption(value, text) {
            document.getElementById('selectedText').innerHTML = text;
            document.querySelector('.select-options').classList.remove('open');
            currentSort = value;
            sortAndRender();
        }

        window.addEventListener('click', function (e) {
            if (!document.querySelector('.custom-select').contains(e.target)) {
                document.querySelector('.select-options').classList.remove('open');
            }
        });

        function scrollToHome() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function shrinkInput(textarea) {
            textarea.style.height = '55px';
            textarea.scrollTop = 0;
        }

        let ticking = false;
        window.addEventListener('scroll', () => {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    const scrollTop = window.scrollY;
                    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollPercent = (scrollTop / docHeight) * 100;
                    document.querySelector('.progress-bar').style.width = scrollPercent + '%';

                    const fab = document.getElementById('scrollTopBtn');
                    if (scrollTop > 400) fab.classList.add('visible');
                    else fab.classList.remove('visible');

                    ticking = false;
                });
                ticking = true;
            }
        });

        function setStatus(msg, type = "neutral") {
            statusDiv.innerText = msg;
            statusDiv.style.color = type === "error" ? "#ff5555" : type === "success" ? "#00f2ea" : "#888";
        }

        async function runLumina() {
            const btn = document.getElementById('btnGo');
            const prompt = document.getElementById('userPrompt').value.trim();
            const textarea = document.getElementById('userPrompt');

            if (abortController) {
                abortController.abort();
                abortController = null;
                btn.innerHTML = '<i class="fa-solid fa-magnifying-glass"></i>';
                btn.style.background = "var(--brand-gradient)";
                setStatus("Search stopped.", "neutral");
                return;
            }
            if (!geminiKey) return setStatus("Ai API Key Error, Contact Developer.", "error");
            if (!prompt) return setStatus("Please enter a movie description.", "error");

            textarea.style.height = '55px';
            textarea.blur();

            abortController = new AbortController();
            const signal = abortController.signal;

            const grid = document.getElementById('movieGrid');
            const controls = document.getElementById('sortControls');

            btn.innerHTML = '<i class="fa-solid fa-circle-stop"></i>';
            btn.style.background = "#ff4b4b";
            setStatus("Searching the best for you...");
            grid.innerHTML = '';
            fetchedMovies = [];
            controls.style.display = 'none';

            try {
                // Fetch Movie Titles from Gemini
                const titles = await fetchGeminiRecommendations(prompt, geminiKey);

                if (!titles || titles.length === 0) {
                    setStatus("AI couldn't find any movies for that. Try a genre like 'Action' or 'Sci-Fi'.", "error");
                    return;
                }

                setStatus(`Found ${titles.length} matches. Loading visuals...`, "success");

                // // Fetch Posters from TMDB
                for (let i = 0; i < titles.length; i++) {
                    if (!abortController) break;

                    let title = titles[i];
                    let movie = await fetchTMDBData(title, tmdbKey);

                    if (!movie) {
                        movie = {
                            title: title,
                            poster_path: "https://demofree.sirv.com/nope-not-here.jpg",
                            vote_average: null,
                            release_date: null,
                            id: `ghost-${Math.random().toString(36).substr(2, 9)}`
                        };
                    }

                    fetchedMovies.push(movie);
                    createMovieCard(movie, i);

                    if (i === 0) controls.style.display = 'flex';
                    await new Promise(r => setTimeout(r, 50));
                }

                if (abortController) setStatus("Ready.", "neutral");

            } catch (error) {
                if (error.name !== 'AbortError') {
                    console.error(error);
                    setStatus(error.message, "error");
                }
            } finally {
                if (abortController) {
                    btn.innerHTML = '<i class="fa-solid fa-magnifying-glass"></i>';
                    btn.style.background = "var(--brand-gradient)";
                    abortController = null;
                }
            }
        }

        function sortAndRender() {
            const grid = document.getElementById('movieGrid');
            if (fetchedMovies.length === 0) return;

            let sortedList = [...fetchedMovies];

            if (currentSort === 'rating_high') {
                sortedList.sort((a, b) => b.vote_average - a.vote_average);
            } else if (currentSort === 'rating_low') {
                sortedList.sort((a, b) => a.vote_average - b.vote_average);
            } else if (currentSort === 'newest') {
                sortedList.sort((a, b) => new Date(b.release_date) - new Date(a.release_date));
            } else if (currentSort === 'oldest') {
                sortedList.sort((a, b) => new Date(a.release_date) - new Date(b.release_date));
            }

            grid.style.opacity = '0';
            setTimeout(() => {
                grid.innerHTML = '';
                grid.style.opacity = '1';
                sortedList.forEach((movie, index) => createMovieCard(movie, index));
                scrollToHome();
            }, 200);
        }

        async function fetchGeminiRecommendations(prompt, apiKey) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`;

            const systemPrompt = `
Â  Â  Â  Â  Â  Â  Â  Â  You are a knowledgeable movie database expert with deep understanding of Global Cinema (including Indian Cinema - Tollywood, Bollywood, Kollywood).

Â  Â  Â  Â  Â  Â  Â  Â  Analyze the specific mood, genre, theme, or era requested in User Query: "${prompt}"

Â  Â  Â  Â  Â  Â  Â  Â  Guidelines for Accuracy:
Â  Â  Â  Â  Â  Â  Â  Â  1. Prioritize movies with high critical acclaim (Rotten Tomatoes/IMDb) or cult status.
Â  Â  Â  Â  Â  Â  Â  Â  2. Avoid TV shows, series, or shorts (Feature films only).
Â  Â  Â  Â  Â  Â  Â  Â  3. Ensure diversity in the list (mix of blockbusters, hidden gems).
Â  Â  Â  Â  Â  Â  Â  Â  4. Use the exact official English title to ensure database lookup success (e.g., use "Star Wars" not "Star Wars Episode IV").
Â  Â  Â  Â  Â  Â  Â  Â  5. If a specific actor/actress is mentioned (e.g., "Megastar"), ONLY list their movies.
Â  Â  Â  Â  Â  Â  Â  Â  6. If fewer than 50 relevant movies exist, return as many as possible without filler titles.
                7. Do NOT include any additional text, explanations, or formatting outside of the JSON array.
                8. Respond in English.
                9. Always include movies upto 2025 if they fit the criteria. this is very important.
                10. Avoid duplicates.
                11. Exclude remakes, reboots, or sequels unless specifically requested.
                12. Focus on original titles rather than translated or localized versions.
                13. Ensure the list is relevant to the user's query.
                14. Avoid overly obscure titles that lack sufficient information for database lookup.
                15. Do NOT include any non-movie entries.
                16. mainly include RECENT MOVIES from 2020, 2021, 2022, 2023, 2024 and 2025. But if the user specifically requests "Classics", "Old", "Vintage", or mentions a specific decade (e.g., "80s", "90s"), include relevant older movies as well.

                Important:
                1.You are a smart Movie Database Translator.
Â  Â  Â  Â  Â  Â  Â  Â  2. Always return the ORIGINAL English Title for Dubbed Movies.
Â  Â  Â  Â  Â  Â  Â  Â  3. If user asks for "Robo", you must return "Enthiran" (2010).
Â  Â  Â  Â  Â  Â  Â  Â  4. If user asks for "Robot", you must return "Enthiran".
Â  Â  Â  Â  Â  Â  Â  Â  5. If user asks for "7th Sense", you must return "7aum Arivu".
Â  Â  Â  Â  Â  Â  Â  Â  6. If user asks for "Yamudu", you must return "Singam".
                7. If user asks for "Hollywood movies dubbed in Telugu", return the ORIGINAL English Titles (e.g., "Transformers", "Avatar", "Iron Man").
                8. Do NOT write "Transformers Telugu". Just write "Transformers".
                9. If user asks for "Robo movies", only return movies featuring Robots.
                10. Prioritize Relevance over Quantity: Do NOT fill the list with random movies like "Baahubali" or "KGF" unless they strictly fit the genre requested.
              
Â  Â  Â  Â  Â  Â  Â  Â  Output Format:
Â  Â  Â  Â  Â  Â  Â  Â  Return ONLY a raw JSON Array of strings. 
Â  Â  Â  Â  Â  Â  Â  Â  No markdown. No extra text.
                OUTPUT ONLY A JSON ARRAY. NO TEXT BEFORE OR AFTER.
Â  Â  Â  Â  Â  Â  Â  Â  
                Example: ["Movie A", "Movie B, "Movie C", ... up to 50 titles]
Â  Â  Â  Â  Â  Â  `;

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: systemPrompt }] }] })
            });

            const data = await response.json();
            if (!response.ok) throw new Error(data.error?.message || "AI connection failed. please try again.");

            let text = data.candidates[0].content.parts[0].text;
            const jsonMatch = text.match(/\[[\s\S]*\]/);

            if (!jsonMatch) throw new Error("Something went wrong. Please try again.");

            try {
                return JSON.parse(jsonMatch[0]);
            } catch (e) {
                throw new Error("Failed to parse AI response.");
            }
        }

        async function fetchTMDBData(title, apiKey) {
            const url = `https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(title)}`;
            const res = await fetch(url);
            const data = await res.json();
            return data.results?.[0];
        }

        function createMovieCard(movie, index = 0) {
            const grid = document.getElementById('movieGrid');
            let posterUrl;
            if (movie.poster_path && movie.poster_path.startsWith('http')) {
                posterUrl = movie.poster_path;
            } else if (movie.poster_path) {
                posterUrl = `https://image.tmdb.org/t/p/w300${movie.poster_path}`;
            } else {
                posterUrl = "https://demofree.sirv.com/nope-not-here.jpg";
            }

            const year = movie.release_date ? movie.release_date.split('-')[0] : '-';

            let ratingDisplay;
            if (movie.vote_average && movie.vote_average > 0) {
                ratingDisplay = `<span class="rating"><i style="color: #f3bd00f0; font-size: 14.5px;" class="fa-solid fa-star"></i> ${movie.vote_average.toFixed(1)}</span>`;
            } else {
                ratingDisplay = `<span class="rating" style="color: #aaa;"><i style="color: #f3bd00f0; font-size: 14.5px;" class="fa-solid fa-star"></i> -</span>`;
            }

            const card = document.createElement('div');
            card.className = 'card';
            card.style.animationDelay = `${index * 50}ms`;

            // Search on click
            card.onclick = () => {
                window.open(`https://www.google.com/search?q=${encodeURIComponent(movie.title + " movie")}`, '_blank');
            };

            card.innerHTML = `
                <div class="poster" style="background-image: url('${posterUrl}')"></div>
                <div class="info">
                    <div class="title">${movie.title}</div>
                    <div class="meta">
                        ${ratingDisplay}
                        <span>${year}</span>
                    </div>
                </div>
            `;
            grid.appendChild(card);
        }

        function handleInput(textarea) {
            const clearBtn = document.getElementById('btnClear');
            textarea.style.height = 'auto';

            if (textarea.value === '') {
                textarea.style.height = '55px';
            } else {
                textarea.style.height = textarea.scrollHeight + 'px';
            }

            if (textarea.value.trim().length > 0) {
                clearBtn.style.display = 'flex';
            } else {
                clearBtn.style.display = 'none';
            }
        }

        function clearSearch() {
            const textarea = document.getElementById('userPrompt');
            textarea.value = '';
            textarea.style.height = '55px';
            textarea.focus();
            document.getElementById('btnClear').style.display = 'none';
            // handleInput(textarea);
            // textarea.style.minHeight = '63px';
        }

    </script>
</body>

</html>
